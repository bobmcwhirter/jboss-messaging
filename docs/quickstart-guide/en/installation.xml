<?xml version="1.0" encoding="UTF-8"?>
<chapter id="installation">
   <title>Installation</title>
   <para>This section describes how to install JBoss Messaging. </para>
   <section id="installation.prerequisites">
      <title>Prerequisites</title>
      <note>
         <para>JBoss Messaging only runs on Java 5 or later. We highly recommend to use Java
            6.</para>
      </note>
      <para>By default, JBoss Messaging server is run with 1GB of memory. If your computer has less
         memory, modify the value in <literal>bin/run.sh</literal> accordingly.</para>
      <para>For persistence, JBoss Messaging uses its own fast journal file, which you can configure
         to use libaio (which is the default when running on Linux) or Java NIO. In order to use the libaio
         module on Linux, it's required to install libaio.</para>
      <para>You can install libaio using the following steps:</para>
      <para>Using yum, (e.g. on Fedora or Red Hat Enterprise Linux):</para>
      <programlisting>sudo yum install libaio</programlisting>
      <para>Using aptitude, (e.g. on Ubuntu or Debian system):</para>
      <programlisting>sudo apt-get install libaio</programlisting>
      <para><ulink url="http://ant.apache.org/">Apache Ant</ulink> is required to create the
         profiles for JBoss AS 5 and run the examples.</para>
   </section>
   <section id="installation.standalone">
      <title>Standalone JBoss Messaging Server</title>
      <para>After downloading the distribution, unzip it into your chosen directory. At this point
         it should be possible to <link linkend="running.standalone">run straight out of the
            box</link>, the following describes the directory structure: </para>
      <programlisting>
         |-- bin
         |-- config
         | |-- jboss-as
         | `-- stand-alone 
         |-- docs
         | |-- api
         | |-- quickstart-guide
         | `-- user-manual
         |-- examples
         | |-- core
         | |-- javaee
         | `-- jms
         |-- lib
         |-- licenses
         `-- schemas
      </programlisting>
      <itemizedlist>
         <listitem>
            <para><literal>bin</literal> -- binaries and scripts needed to run JBoss
               Messaging</para>
         </listitem>
         <listitem>
            <para><literal>config</literal> -- configuration files needed to configure JBoss
               Messaging. This contains configurations to run JBoss Messaging either in stand-alone
               or inside JBoss AS 5. Please refer to the reference guide for details on
               configuration. </para>
         </listitem>
         <listitem>
            <para><literal>docs</literal> -- guides and javadocs for JBoss Messaging </para>
         </listitem>
         <listitem>
            <para><literal>examples</literal> -- JMS and Java EE examples. Please refer to the
               'running examples' chapter for details on how to run them. </para>
         </listitem>
         <listitem>
            <para><literal>lib</literal> -- jars and libraries needed to run JBoss Messaging </para>
         </listitem>
         <listitem>
            <para><literal>licenses</literal> -- licenses for JBoss Messaging </para>
         </listitem>
         <listitem>
            <para><literal>schemas</literal> -- XML Schemas used to validate JBoss Messaging
               configuration files</para>
         </listitem>
      </itemizedlist>
   </section>
   <section id="installation.jboss">
      <title>JBoss Messaging In JBoss AS 5</title>
      <para>JBoss Messaging 2.0 can be deployed in <ulink url="http://www.jboss.org/jbossas/">JBoss
            AS 5</ulink>. It is not shipped by default with the application server and you need to
         create new AS 5 profiles to run AS 5 with JBoss Messaging.</para>
      <para>To create AS 5 profiles:</para>
      <orderedlist>
         <listitem>
            <para>Download JBoss AS 5</para>
         </listitem>
         <listitem>
            <para>Set the environment property <literal>JBOSS_HOME</literal> to point to the
               directory where you installed JBoss AS 5</para>
         </listitem>
         <listitem>
            <para>run <literal>ant</literal> in JBoss Messaging's <literal>config/jboss-as</literal>
               directory</para>
         </listitem>
      </orderedlist>
      <para>This will create 2 new profiles in <literal>$JBOSS_HOME/server</literal>:</para>
      <itemizedlist>
         <listitem>
            <para><literal>default-with-jbm2</literal> -- it corresponds to AS 5 <literal
                  >default</literal> profile with JBoss Messaging 2 as its JMS provider. In this
               profile, JBoss Messaging is <emphasis>non-clustered</emphasis></para>
         </listitem>
         <listitem>
            <para><literal>all-with-jbm2</literal> -- it corresponds to AS 5 <literal>all</literal>
               profile with JBoss Messaging 2 as its JMS provider. In this profile, JBoss Messaging
               is <emphasis>clustered</emphasis></para>
         </listitem>
      </itemizedlist>
      <para>You can then start JBoss AS 5 using one of these profiles:</para>
      <programlisting>$JBOSS_HOME/bin/run.sh -c default-with-jbm2</programlisting>
   </section>
</chapter>
