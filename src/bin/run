#!/bin/sh
#
# bash script for running various JBoss Messaging command line tools
#
#

CLESTER_HOME=/work/clester/dist
TARGET_CLASS=org.jboss.messaging.tools.PipeClient
TARGET_CLASS=org.jboss.messaging.tools.JChannelClient
TARGET_CLASS=org.jboss.messaging.tools.RpcDispatcherClient
TARGET_CLASS=org.jboss.messaging.tools.DistributedPipeClient
#TARGET_CLASS=org.jboss.messaging.tools.ToErase
TARGET_CLASS=org.jboss.messaging.tools.DistributedQueueClient
TARGET_CLASS=org.jboss.messaging.tools.ReplicatorClient

cygwin=false;
case "`uname`" in
    CYGWIN*)
        cygwin=true
        ;;
esac

if [ $cygwin = true ]; then
    SEP=";"
else
    SEP=":"
fi

#for i in `ls $JBOSS_HOME/client/*.jar`; do
#	JBOSS_CLASSPATH=$i${SEP}$JBOSS_CLASSPATH
#done

while [ "$1" != "" ]; do
    if [ "$1" = "-debug" ]; then
        if [ $cygwin = false ]; then
            JAVA_OPTS="-Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=12348"
        else
            JAVA_OPTS="-Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_shmem,server=y,suspend=y,address=mess"
        fi
    fi
    shift
done

#Temporarily use a newer JGroups version, not available in the thirdparty dir
#$reldir/../../../thirdparty/javagroups-javagroups/lib/jgroups.jar${SEP}\

reldir=`dirname $0` 
java $JAVA_OPTS -cp \
$reldir/../../output/etc${SEP}\
$reldir/../../output/classes${SEP}\
$reldir/../../../thirdparty/apache-log4j/lib/log4j.jar${SEP}\
$reldir/../../../thirdparty/apache-commons/lib/commons-logging.jar${SEP}\
$reldir/../../../thirdparty/oswego-concurrent/lib/concurrent.jar${SEP}\
$reldir/../../../common/output/lib/jboss-common.jar${SEP}\
$reldir/../resources/jgroups-core.jar${SEP}\
${CLESTER_HOME}/clester.jar \
org.clester.Main $TARGET_CLASS

