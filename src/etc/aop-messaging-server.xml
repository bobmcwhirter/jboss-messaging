<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE aop PUBLIC
   "-//JBoss//DTD JBOSS AOP 1.0//EN"
   "http://www.jboss.org/aop/dtd/jboss-aop_1_0.dtd">
<aop>

   <interceptor class="org.jboss.jms.server.container.LogInterceptor" scope="PER_VM"/>   
   <interceptor class="org.jboss.jms.server.container.CachingInterceptor" scope="PER_VM"/>      
   <aspect class="org.jboss.jms.server.container.SecurityAspect" scope="PER_VM"/>
   <aspect class="org.jboss.jms.server.container.InjectionAspect" scope="PER_VM"/>

   <!-- Connection -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.ConnectionAdvised->$implementing{org.jboss.jms.server.endpoint.ConnectionEndpoint}(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>
   </bind>

   <!-- Session -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.SessionAdvised->$implementing{org.jboss.jms.server.endpoint.SessionEndpoint}(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.SessionAdvised->createProducerDelegate(..))">
      <advice name="handleCreateProducerDelegate" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.SessionAdvised->createBrowserDelegate(..))">
      <advice name="handleCreateBrowserDelegate" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.SessionAdvised->createConsumerDelegate(..))">
      <advice name="handleCreateConsumerDelegate" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>   
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.SessionAdvised->createConsumerDelegate(..))">
      <advice name="handleCreateConsumerDelegate" aspect="org.jboss.jms.server.container.InjectionAspect"/>
   </bind>

   <!-- Producer -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.ProducerAdvised->$implementing{org.jboss.jms.server.endpoint.ProducerEndpoint}(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>    
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.ProducerAdvised->send(..))">
      <advice name="handleSend" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>

   <!-- Consumer -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.ConsumerAdvised->$implementing{org.jboss.jms.server.endpoint.ConsumerEndpoint}(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>    
   </bind>

   <!-- Browser -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.advised.BrowserAdvised->$implementing{org.jboss.jms.server.endpoint.BrowserEndpoint}(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>    
   </bind>
   
</aop>