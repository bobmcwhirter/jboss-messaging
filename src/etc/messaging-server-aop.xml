<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE aop PUBLIC
   "-//JBoss//DTD JBOSS AOP 1.0//EN"
   "http://www.jboss.org/aop/dtd/jboss-aop_1_0.dtd">

<aop>

   <interceptor class="org.jboss.jms.server.container.LogInterceptor" scope="PER_VM"/>   
   <interceptor class="org.jboss.jms.server.container.CachingInterceptor" scope="PER_VM"/>      
   <aspect class="org.jboss.jms.server.container.SecurityAspect" scope="PER_VM"/>
   <aspect class="org.jboss.jms.server.container.InjectionAspect" scope="PER_VM"/>

   <!-- ConnectionFactory -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.ConnectionFactoryEndpointDelegate->*(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>
   </bind>

   <!-- Connection -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.ConnectionEndpointDelegate->*(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>
   </bind>

   <!-- Session -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.SessionEndpointDelegate->*(..)) AND !execution(* org.jboss.jms.server.endpoint.delegate.SessionEndpointDelegate->getEndpoint(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.SessionEndpointDelegate->createProducerDelegate(..))">
      <advice name="handleCreateProducerDelegate" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.SessionEndpointDelegate->createBrowserDelegate(..))">
      <advice name="handleCreateBrowserDelegate" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.SessionEndpointDelegate->createConsumerDelegate(..))">
      <advice name="handleCreateConsumerDelegate" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>   
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.SessionEndpointDelegate->createConsumerDelegate(..))">
      <advice name="handleCreateConsumerDelegate" aspect="org.jboss.jms.server.container.InjectionAspect"/>
   </bind>

   <!-- Producer -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.ProducerEndpointDelegate->*(..)) AND !execution(* org.jboss.jms.server.endpoint.delegate.ProducerEndpointDelegate->getEndpoint(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>    
   </bind>
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.ProducerEndpointDelegate->send(..))">
      <advice name="handleSend" aspect="org.jboss.jms.server.container.SecurityAspect"/>
   </bind>

   <!-- Consumer -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.ConsumerEndpointDelegate->*(..)) AND !execution(* org.jboss.jms.server.endpoint.delegate.ConsumerEndpointDelegate->getEndpoint(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>    
   </bind>

   <!-- Browser -->
   <bind pointcut="execution(* org.jboss.jms.server.endpoint.delegate.BrowserEndpointDelegate->*(..)) AND !execution(* org.jboss.jms.server.endpoint.delegate.BrowserEndpointDelegate->getEndpoint(..))">
      <interceptor-ref name="org.jboss.jms.server.container.LogInterceptor"/>    
   </bind>
   
</aop>