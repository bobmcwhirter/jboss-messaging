<?xml version="1.0" encoding="UTF-8"?>

<!--
     The JBoss Messaging service deployment descriptor.

     $Id$
 -->

<server>

   <!--
   <loader-repository>jboss.messaging:name=ScopedLoaderRepository
       <loader-repository-config>java2ParentDelegation=false</loader-repository-config>
   </loader-repository>
   -->

   <!--
   <mbean code="org.jboss.aop.deployment.AspectManagerService"
      name="jboss.messaging:service=AspectManager">
   </mbean>

   <mbean code="org.jboss.aop.deployment.AspectDeployer"
      name="jboss.messaging:service=AspectDeployer">
   </mbean>
   -->

   <!-- JBoss 5 has a remoting connector already deployed. For JBoss 4, I need to deploy it. -->
   <!--
   <mbean code="org.jboss.remoting.transport.Connector"
          xmbean-dd="org/jboss/remoting/transport/Connector.xml"
          name="jboss.messaging:service=Connector,transport=socket"
          display-name="Socket transport Connector">
      <attribute name="Configuration">
         <config>
            <invoker transport="socket">
               <attribute name="dataType" isParam="true">invocation</attribute>
               <attribute name="marshaller" isParam="true">org.jboss.invocation.unified.marshall.InvocationMarshaller</attribute>
               <attribute name="unmarshaller" isParam="true">org.jboss.invocation.unified.marshall.InvocationUnMarshaller</attribute>
               <attribute name="serverBindAddress">${jboss.bind.address}</attribute>
               <attribute name="serverBindPort">4447</attribute>
            </invoker>
            <handlers>
               <handler subsystem="placeholder">org.jboss.jms.client.remoting.ServerInvocationHandlerImpl</handler>
            </handlers>
         </config>
      </attribute>
      <depends>jboss.messaging:service=NetworkRegistry</depends>
      <depends>jboss.messaging:service=AspectDeployer</depends>
   </mbean>

   <mbean code="org.jboss.remoting.network.NetworkRegistry"
          name="jboss.messaging:service=NetworkRegistry"/>
   -->

   <!--
   <mbean code="org.jboss.jms.util.AspectLoader"
      name="jboss.messaging:service=AspectLoader"
      xmbean-dd="xmdesc/AspectLoader-xmbean.xml">
      <depends>jboss.messaging:service=AspectDeployer</depends>
      <depends optional-attribute-name="MainDeployer">jboss.system:service=MainDeployer</depends>
   </mbean>
   -->

	<!-- The JMS Security Manager -->
   <!--
	<mbean code="org.jboss.jms.security.SecurityManager" name="jboss.messaging:service=SecurityManager">
		<attribute name="DefaultSecurityConfig">
			<security>
				<role name="guest" read="true" write="true" create="true"/>
			</security>
		</attribute>
		<attribute name="SecurityDomain">java:/jaas/messaging</attribute>
	</mbean>
   -->

   <!-- The Server Peer -->
   <mbean code="org.jboss.jms.server.ServerPeer"
      name="jboss.messaging:service=ServerPeer"
      xmbean-dd="xmdesc/ServerPeer-xmbean.xml">
      <constructor>
         <!-- serverPeerID -->
         <arg type="java.lang.String" value="0" />
         <arg type="java.lang.String" value="jdbc:hsqldb:hsql://localhost:1701" />
      </constructor>
      <depends optional-attribute-name="Connector">jboss.remoting:service=Connector,transport=socket</depends>
      <depends>jboss.jca:service=DataSourceBinding,name=DefaultDS</depends>
      <!--
      <depends>jboss.messaging:service=AspectLoader</depends>
      -->
      <attribute name="SecurityDomain">java:/jaas/messaging</attribute>
      <attribute name="DefaultSecurityConfig">
			<security>
				<role name="guest" read="true" write="true" create="true"/>
            			<role name="Administrator" read="true" write="true" create="true"/>
			</security>
		</attribute>
   </mbean>
   
   
   <!-- Test destinations -->
      
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=testTopic">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
      <attribute name="SecurityConfig">
         <security>
            <role name="guest" read="true" write="true"/>
            <role name="publisher" read="true" write="true" create="false"/>
            <role name="durpublisher" read="true" write="true" create="true"/>
         </security>
      </attribute>
   </mbean>
   
   
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=securedTopic">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
      <attribute name="SecurityConfig">
         <security>
            <role name="publisher" read="true" write="true" create="false"/>
         </security>
      </attribute>
   </mbean>

   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=testDurableTopic">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
      <attribute name="SecurityConfig">
         <security>
            <role name="guest" read="true" write="true"/>
            <role name="publisher" read="true" write="true" create="false"/>
            <role name="durpublisher" read="true" write="true" create="true"/>
         </security>
      </attribute>
   </mbean>

   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=testQueue">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
      <attribute name="SecurityConfig">
         <security>
            <role name="guest" read="true" write="true"/>
            <role name="publisher" read="true" write="true" create="false"/>
            <role name="noacc" read="false" write="false" create="false"/>
         </security>
      </attribute>
   </mbean>
      
      
     
   <!-- Example queues -->   
   
   
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=A">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=B">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=C">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=D">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>   

   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=ex">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <!-- Needed for performance testing -->
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
         name="jboss.messaging.destination:service=Queue,name=perfTestQueue">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue0">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>

   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue1">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue2">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue3">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue4">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue5">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue6">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue7">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue8">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Queue"
      name="jboss.messaging.destination:service=Queue,name=perfTestQueue9">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
         name="jboss.messaging.destination:service=Topic,name=perfTestTopic">
         <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic0">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>

   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic1">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic2">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic3">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic4">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic5">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic6">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic7">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic8">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   
   <mbean code="org.jboss.jms.server.jmx.Topic"
      name="jboss.messaging.destination:service=Topic,name=perfTestTopic9">
      <depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
   </mbean>
   


</server>